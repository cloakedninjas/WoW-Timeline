<?php

$data = array();
$i = 0;

foreach ($this->char->achievements_by_day as $day=>$achvs) {
	$achvs = explode(',', $achvs);

	$obj = new stdClass();
	$obj->y = date("Y", $day);
	$obj->m = date("M", $day);
	$obj->mm = date("m", $day);
	$obj->da = date("j", $day);

	$obj->a = array();
	//$obj->d = array();

	foreach ($achvs as $a) {
		$i++;
		$obj2 = new stdClass();
		$obj2->n = $this->achievements->cross_ref[$a]->name;
		$obj2->d = $this->achievements->cross_ref[$a]->description;

		if ($this->achievements->cross_ref[$a]->noteable) {
			$obj2->no = true;
		}

		$obj->a[] = $obj2;

		//$obj->a[] = $this->achievements->cross_ref[$a]->name;
		//$obj->d[] = $this->achievements->cross_ref[$a]->description;


		//if ($this->achievement_ref->achievementIsNotable($this->achievement_ref[$a]-)
	}

	$data[] = $obj;

	if ($i >= $this->char->load_count) {
		break;
	}
}

?>

<script type="text/javascript">
Timeline.data = <?php echo json_encode($data); ?>;
Timeline.total_entries = <?php echo count($this->char->achievements_by_day); ?>;
Timeline.total_achvs = <?php echo count($this->char->achievements); ?>;
Timeline.total_points = <?php echo $this->char->achievement_points; ?>;

$(document).ready(function() {
	Timeline.init();
});
</script>

<div id="header">

	<div class="profile">
		<div class="thumb" style="background-image: url(http://eu.battle.net/static-render/eu/lightbringer/190/34244286-avatar.jpg)"></div>
		<h1><span class="name">Halbu</span><span class="title">, the awesome</span></h1>
		<h2>&lt; Untouchables &gt;</h2>
		<h3>
			<span class="level">85</span><span class="race">Night Elf</span><span class="class c6">Death Knight</span>
		</h3>
	</div>
</div>

<div id="timeline">
	<div id="time_index">
		<div class="exp cata"></div>
		<div class="exp wotlk"></div>
		<div class="exp tbc"></div>
		<!--
		Achvs intro : October 14, 2008
		Wotlk release: November 13, 2008
		 -->
	</div>
	<div class="entries"></div>
</div>

<div id="entry_template" class="entry">
	<span class="date"></span>
	<span class="l"></span>
</div>

<div id="notable_template" class="entry notable">
	<span class="date"></span>
</div>